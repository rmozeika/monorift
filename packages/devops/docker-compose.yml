version: "3"
services:
  webserver:
    image: nginx:mainline-alpine
    container_name: webserver
    # restart: unless-stopped
    ports:
      - "8084:80"
      - "4443:443"
    expose:
      - "80"
      - "443"
    volumes:
      - '../../private:/private'
      -  ./data/logs/nginx:/var/log/nginx
      - ./nginx/remote.conf:/etc/nginx/nginx.conf
      # - certbot-etc:/etc/letsencrypt
      # - certbot-var:/var/lib/letsencrypt
    depends_on:
      - node
    links:
      - node
  node:
    #network_mode: host
    image: "node:10"
    restart: unless-stopped
    ports:
      - "8080:8080"
    # command: ["./wait-for-it.sh", "db-svc:27017", "--", "npm", "start"]
    # command: "npm start"
    volumes: 
      - ./data/logs:/logs
      - ./data/logs/node:/var/log/node
    depends_on: 
      - db-svc
    links: 
      - db-svc
  db-svc:
    #network_mode: host
    image: mongo:latest
    container_name: "mongo"
    environment:
      - MONGO_DATA_DIR=/data/db
      - MONGO_LOG_DIR=/data/logs
    volumes:
      - ./data/db:/data/db
      - ./data/logs/mongo:/data/logs

    ports:
        - 27017:27017
# volumes: 
#   data-volume:
#Docker Networks
# networks:
#   app-network:
#     driver: bridge


    